const{keys:A}=Object;var b=a=>a==void 0;function c(){try{new Function('(a = 0) => a');new Function('let x = 1')}catch(e){return!0}if(typeof Symbol==='undefined'||typeof Promise==='undefined'||Object.assign==void 0||Array.prototype.find==void 0)return!0;return!1}let d=null;c()?d=_=>{var B=Array.prototype.slice.call(arguments,1);return _.replace(/\{(\d+)\}/g,function(C,_b){return !b(B[_b])?B[_b]:C})}:d=(_a,...D)=>_a.replace(/\{(\d+)\}/g,(_A,_B)=>(!b(D[_B])?D[_B]:_A));!(function($){$.timeoutDialog=function(e){var E={timeout:1200,countdown:60,title:'Your session is about to expire!',message:'You will be logged out in {0} seconds.',question:'Do you want to stay logged in?',keepAliveButtonText:'Yes, Keep me signed in',signOutButtonText:'No, Sign me out',keepAliveUrl:'/keep-alive',logoutUrl:null,logoutRedirectUrl:'/',restartOnYes:!0,dialogWidth:'auto',enableClientEvents:!1,ajaxSettings:{type:'POST',url:this.keepAliveUrl,contentType:'application/json',dataType:'json',cache:!1,headers:{Accept:'application/json'}}},_d={init:function(){const aA=this;aA.setupDialogTimer();E.enableClientEvents&&(document.addEventListener('mouseover',aA.setupDialogTimer,!1),document.addEventListener('mousemove',aA.setupDialogTimer,!1),document.addEventListener('mousedown',aA.setupDialogTimer,!1),document.addEventListener('wheel',aA.setupDialogTimer,!1),document.addEventListener('mousewheel',aA.setupDialogTimer,!1),document.addEventListener('touchmove',aA.setupDialogTimer,!1),document.addEventListener('pointermove',aA.setupDialogTimer,!1),document.addEventListener('keypress',aA.setupDialogTimer,!1))},setupDialogTimer:function(){window.clearTimeout(_c);_c=window.setTimeout(function(){_d.setupDialog()},(E.timeout-E.countdown)*1000)},setupDialog:function(){const aB=this,_C=$('<p>',{id:'timeout-message'});aB.destroyDialog();const aC=$('<div>',{id:'timeout-dialog'});_C.append(d(E.message,'<span id="timeout-countdown">'+E.countdown+'</span>'));aC.append(_C);aC.append('<p id="timeout-question">'+E.question+'</p>');$(aC).appendTo('body').dialog({modal:!0,width:E.dialogWidth,minHeight:'auto',zIndex:10000,closeOnEscape:!1,draggable:!1,resizable:!1,dialogClass:'timeout-dialog',title:E.title,classes:{'ui-dialog':'timeout-dialog'},buttons:{'keep-alive-button':{text:E.keepAliveButtonText,id:'timeout-keep-signin-btn',click:function(){aB.keepAlive()}},'sign-out-button':{text:E.signOutButtonText,id:'timeout-sign-out-button',click:function(){aB.signOut(!0)}}}});aB.startCountdown()},destroyDialog:function(){const aD=$('#timeout-dialog');aD.length&&(aD.dialog('close'),aD.remove())},startCountdown:function(){const aE=this;let aF=E.countdown;this.countdown=window.setInterval(function(){aF-=1;$('#timeout-countdown').html(aF);aF<=0&&(window.clearInterval(aE.countdown),aE.signOut(!1))},1000)},keepAlive:function(){const aG=this;aG.destroyDialog();window.clearInterval(this.countdown);$.ajax($.extend(!0,{type:'POST', url:E.keepAliveUrl, contentType:'application/json; charset=utf-8', dataType:'json', cache:!1},E.ajaxSettings)).done(aH=>{if(aH&&aH==='OK')E.restartOnYes&&aG.setupDialogTimer();else aG.signOut(!1)}).catch((aI,aJ,aK)=>{let _D='';aJ&&(_D+=`Error: ${aJ}`);aK&&(_D+=` \nMessage: ${aK}`);const _e=aI&&A(aI).length>0;_e&&(_D+=` \nRequest: ${JSON.stringify(aI,null,2)}`);_D&&console.error(_D)})},signOut:function(aL){const aM=this;aM.destroyDialog();E.logoutUrl?$.post(E.logoutUrl,function(aN){aM.redirectLogout(aL)}):aM.redirectLogout(aL)},redirectLogout:function(aO){const aP=encodeURIComponent(window.location.pathname+window.location.search);let aQ=`${E.logoutRedirectUrl}?next=${aP}`;!aO&&(aQ+='&timeout=t');window.location=aQ}};$.extend(!0,E,e);let _c;_d.init()}})(window.jQuery);
